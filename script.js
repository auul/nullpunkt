var canvas = document.getElementById("Canvas");
var ctx    = canvas.getContext("2d");

class Bitmap
{
	constructor(width, height, bitString)
	{
		let size = width * height;

		this.rect   = [0, 0, width, height];
		this.width  = width;
		this.height = height;
		this.bmp    = new Array(size);

		if (bitString) {
			for (let i = 0; i < size; i++) {
				if (bitString.charAt(i) == "1") {
					this.bmp[i] = true;
				} else {
					this.bmp[i] = false
				}
			}
		} else {
			for (let i = 0; i < size; i++) {
				this.bmp[i] = false;
			}
		}
	}

	getWidth() { return this.rect[2]; }
	getHeight() { return this.rect[3]; }

	blit(rect, x, y, scale, color)
	{
		if (!rect) { rect = this.rect; }

		ctx.fillStyle = color;

		for (let j = 0; j < rect[3]; j++) {
			for (let i = 0; i < rect[2]; i++) {
				if (this.bmp[i + rect[0]
					     + (j + rect[1]) * this.rect[2]]) {
					ctx.fillRect(x + scale * i,
						     y + scale * j, scale,
						     scale);
				}
			}
		}
	}
}

const font = new Bitmap(
 96, 48,
 "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000010100011110100010001000000000000100010000101010001000000000000000000000000010000000001000010100111110101000000100010100001000001000001000011100001000000000000000000000000100000000001000010100010100011100001000011000001000001000001000111110111110000000111110000000001000000000000000000000111110001010010000100100000000001000001000011100001000000100000000001000010000000000001000000000010100111100100010011010000000000100010000101010001000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100001000011100011100001100111110011100111110011100011100000000000000000100000000010000011100100110011000100010100010010100100000100000000010100010100010000100000100001000111110001000100010101010001000001100001100100100111100111100000100011100011110000000000000010000000000000100001100110010001000010000100010111110000010100010001000100010000010000100000100001000111110001000000000011100011100111110011100000100111100011100001000011100011100000000001000000100000000010000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100011100111100011100111100111110111110011110100010111110000010100010100000110110100010011100100010100010100010100010100010100000100000100000100010001000000010100100100000101010110010100010101110111110111100100000100010111100111100101110111110001000100010111000100000101010101010100010100000100010100010100010100010100000100000100010100010001000100010100100100000101010100110100010011100100010111100011100111100111110100000011100100010111110011100100010111110100010100010011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100011100111100011110111110100010100010100010100010100010111110011100100000011100000000000000100010100010100010100000001000100010100010101010010100100010000100010000010000000100001000000000111100101010111100011100001000100010100010101010001000010100001000010000001000000100010100000000100000100110100010000010001000100010010100101010010100001000010000010000000100000100000000000000100000011110100010111100001000011100001000110110100010001000111110011100000010011100000000111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100111100011100111100111110111110011110100010111110000010100010100000110110100010011100001000100010100010100010100010100000100000100000100010001000000010100100100000101010110010100010000100111110111100100000100010111100111100101110111110001000100010111000100000101010101010100010000000100010100010100010100010100000100000100010100010001000100010100100100000101010100110100010000000100010111100011100111100111110100000011100100010111110011100100010111110100010100010011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111100011100111100011110111110100010100010100010100010100010111110000100001000010000000000000000100010100010100010100000001000100010100010101010010100100010000100001000001000001000000000000000111100101010111100011100001000100010100010101010001000010100001000011000001000001100011010000000100000100110100010000010001000100010010100101010010100001000010000001000001000001000101100000000100000011110100010111100001000011100001000110110100010001000111110000100001000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");

class Board
{
	constructor(rect, cols, rows, bitString)
	{
		let scale = 1.0;

		if (rect[2] / cols < rect[3] / rows) {
			scale = rect[2] / cols;
		} else {
			scale = rect[3] / rows;
		}

		rect[0] += rect[2] - scale * cols;
		rect[1] += rect[3] - scale * rows;
		rect[2]   = scale * cols;
		rect[3]   = scale * rows;
		this.rect = rect;

		let size  = cols * rows;
		this.grid = new Array(size);

		for (let i = 0; i < size; i++) {
			if (bitString.charAt(i) == "1") {
				this.grid[i] = true;
			} else {
				this.grid[i] = false;
			}
		}
	}
}

function clearScreen()
{
	ctx.fillStyle = "#000000";
	ctx.fillRect(0, 0, canvas.width, canvas.height);
}

function writeText(x, y, scale, color, string)
{
	let rect  = [0, 0, 6, 6];
	let rectX = 0;
	let rectY = 0;
	let c     = 0;

	for (let i = 0; i < string.length; i++) {
		c = string.charCodeAt(i);
		if (c < 256) {
			rect[1] = Math.floor(c / 16) * 6;
			rect[0] = (c % 16) * 6;
			font.blit(rect, x, y, scale, color);
			x += 6 * scale;
		}
	}
}

window.addEventListener("load", () => {
	clearScreen();
	writeText(50, 100, 2, "#ff0000", "Hello, World!");
});
